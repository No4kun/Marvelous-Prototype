<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>固有値・固有ベクトルの探求 - 線形変換の本質</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/course-navigation.css">
    <link rel="stylesheet" href="styles/basis-transformation.css">
</head>
<body>
    <!-- Modern Header with Glassmorphism -->
    <header>
        <div class="header-nav">
            <button class="home-btn" onclick="window.location.href='index.html'" title="ホームページに戻る">
                <i class="fas fa-home"></i>
                <span>ホーム</span>
            </button>
            <div class="course-info">
                <h1>固有値・固有ベクトルの探求</h1>
                <h2>線形変換の本質 - インタラクティブ学習</h2>
            </div>
            <button class="pause-btn" onclick="pauseAllAnimations()" title="アニメーションを一時停止">
                <i class="fas fa-pause"></i>
                <span>一時停止</span>
            </button>
        </div>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="learning-progress"></div>
            </div>
        </div>
    </header>

    <!-- Modern Learning Path Navigation -->
    <nav class="section-nav">
        <div class="container">
            <button class="nav-btn active" data-section="0">
                <i class="fas fa-star"></i>
                <span>導入</span>
            </button>
            <button class="nav-btn" data-section="1">
                <i class="fas fa-book-open"></i>
                <span>定義</span>
            </button>
            <button class="nav-btn" data-section="2">
                <i class="fas fa-eye"></i>
                <span>視覚化</span>
            </button>
            <button class="nav-btn" data-section="3">
                <i class="fas fa-calculator"></i>
                <span>計算方法</span>
            </button>
            <button class="nav-btn" data-section="4">
                <i class="fas fa-cogs"></i>
                <span>応用例</span>
            </button>
            <button class="nav-btn" data-section="5">
                <i class="fas fa-dumbbell"></i>
                <span>演習問題</span>
            </button>
        </div>
    </nav>

    <!-- Modern Container Layout -->
    <div class="container">
        <!-- Main Canvas Container -->
        <div class="canvas-container">
            <canvas id="canvas"></canvas>
        </div>

        <!-- Modern Control Panel -->
        <div class="control-panel">
            <div class="control-header">
                <h3>
                    <i class="fas fa-sliders-h"></i>
                    インタラクティブ制御
                </h3>
                <p>固有値・固有ベクトルを動的に探求しましょう</p>
            </div>
            <div class="control-content" id="control-content">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Hidden Content Templates -->
    <div style="display: none;">
        <!-- Section 0: Introduction Content -->
        <div id="content-0" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-star"></i>
                    なぜ固有値・固有ベクトルを学ぶのか？
                </h3>
                <p class="section-subtitle">線形変換の本質を理解する</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-lightbulb"></i>
                    <h4>物理的直感</h4>
                </div>
                <p>固有ベクトルは「線形変換によって方向が変わらないベクトル」です。これは物理学において重要な意味を持ちます：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li><strong>振動系</strong>: 分子の振動モード、建物の固有振動</li>
                    <li><strong>力学系</strong>: 主慣性軸、安定性解析</li>
                    <li><strong>量子力学</strong>: エネルギー固有状態</li>
                </ul>
            </div>

            <div class="form-group">
                <label>変換の種類を選択</label>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="setTransformation('stretch')">
                        <i class="fas fa-arrows-alt-h"></i>
                        <span>伸縮</span>
                    </button>
                    <button class="btn btn-secondary" onclick="setTransformation('rotation')">
                        <i class="fas fa-redo-alt"></i>
                        <span>回転</span>
                    </button>
                    <button class="btn btn-secondary" onclick="setTransformation('shear')">
                        <i class="fas fa-italic"></i>
                        <span>せん断</span>
                    </button>
                </div>
            </div>

            <button class="btn btn-primary" onclick="nextSection(0)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 1: Definition Content -->
        <div id="content-1" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-book-open"></i>
                    固有値・固有ベクトルの定義
                </h3>
                <p class="section-subtitle">数学的な定式化を理解する</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-formula"></i>
                    基本定義
                </h4>
                <p>行列 A に対して、以下を満たすベクトル v と スカラー λ：</p>
                <div class="math-formula">
                    $$Av = \lambda v$$
                </div>
                <p>ここで、v ≠ 0 を<strong>固有ベクトル</strong>、λ を<strong>固有値</strong>と呼びます。</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-search"></i>
                    固有値の求め方
                </h4>
                <p>特性方程式を解きます：</p>
                <div class="math-formula">
                    $$\det(A - \lambda I) = 0$$
                </div>
            </div>

            <div class="form-group">
                <label>行列の要素を設定</label>
                <div class="matrix-input" id="eigenvalue-matrix">
                    <input type="number" step="0.1" value="2" data-row="0" data-col="0">
                    <input type="number" step="0.1" value="1" data-row="0" data-col="1">
                    <input type="number" step="0.1" value="1" data-row="1" data-col="0">
                    <input type="number" step="0.1" value="2" data-row="1" data-col="1">
                </div>
            </div>

            <button class="btn btn-success" onclick="calculateEigenvalues()">
                <i class="fas fa-calculator"></i>
                <span>固有値を計算</span>
            </button>

            <div id="eigenvalue-result" class="status-indicator" style="display: none;"></div>

            <button class="btn btn-primary" onclick="nextSection(1)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 2: Visualization Content -->
        <div id="content-2" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-eye"></i>
                    固有ベクトルの視覚化
                </h3>
                <p class="section-subtitle">変換の幾何学的理解</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-info-circle"></i>
                    <h4>視覚化のポイント</h4>
                </div>
                <p>固有ベクトルは変換前後で方向を保ちます。固有値が：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li><strong>λ > 1</strong>: ベクトルが伸びる</li>
                    <li><strong>0 < λ < 1</strong>: ベクトルが縮む</li>
                    <li><strong>λ < 0</strong>: ベクトルが反転</li>
                </ul>
            </div>

            <div class="form-group">
                <label>固有値 λ₁</label>
                <input type="range" class="form-input" id="eigenvalue1" min="-3" max="3" step="0.1" value="2">
                <span class="input-value" id="eigenvalue1-value">2.0</span>
            </div>

            <div class="form-group">
                <label>固有値 λ₂</label>
                <input type="range" class="form-input" id="eigenvalue2" min="-3" max="3" step="0.1" value="0.5">
                <span class="input-value" id="eigenvalue2-value">0.5</span>
            </div>

            <div class="button-group">
                <button class="btn btn-success" onclick="animateTransformation()">
                    <i class="fas fa-play"></i>
                    <span>アニメーション開始</span>
                </button>
                <button class="btn btn-secondary" onclick="resetVisualization()">
                    <i class="fas fa-undo"></i>
                    <span>リセット</span>
                </button>
            </div>

            <button class="btn btn-primary" onclick="nextSection(2)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 3: Calculation Methods -->
        <div id="content-3" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-calculator"></i>
                    計算方法の実践
                </h3>
                <p class="section-subtitle">手計算とアルゴリズム</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-step-forward"></i>
                    計算手順
                </h4>
                <ol style="padding-left: 1.5rem; line-height: 1.8;">
                    <li>特性多項式 det(A - λI) を計算</li>
                    <li>特性方程式を解いて固有値を求める</li>
                    <li>各固有値に対して (A - λI)v = 0 を解く</li>
                    <li>固有ベクトルを正規化</li>
                </ol>
            </div>

            <div class="form-group">
                <label>練習問題：2×2行列</label>
                <div class="matrix-input" id="practice-matrix">
                    <input type="number" step="1" value="3" data-row="0" data-col="0">
                    <input type="number" step="1" value="1" data-row="0" data-col="1">
                    <input type="number" step="1" value="0" data-row="1" data-col="0">
                    <input type="number" step="1" value="2" data-row="1" data-col="1">
                </div>
            </div>

            <button class="btn btn-success" onclick="solvePractice()">
                <i class="fas fa-check"></i>
                <span>解答を確認</span>
            </button>

            <div id="practice-solution" class="math-card" style="display: none;">
                <h4>解答</h4>
                <div id="solution-content"></div>
            </div>

            <button class="btn btn-primary" onclick="nextSection(3)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 4: Applications -->
        <div id="content-4" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-cogs"></i>
                    実世界への応用
                </h3>
                <p class="section-subtitle">理論から実践へ</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-rocket"></i>
                    <h4>工学・科学での応用</h4>
                </div>
                <ul style="padding-left: 1rem; line-height: 1.8;">
                    <li><strong>構造力学</strong>: 固有振動数による耐震設計</li>
                    <li><strong>制御工学</strong>: システムの安定性解析</li>
                    <li><strong>機械学習</strong>: 主成分分析（PCA）</li>
                    <li><strong>量子物理</strong>: エネルギー準位の計算</li>
                </ul>
            </div>

            <div class="form-group">
                <label>応用例を選択</label>
                <select class="form-select" id="application-type">
                    <option value="vibration">振動解析</option>
                    <option value="pca">主成分分析</option>
                    <option value="stability">安定性解析</option>
                    <option value="quantum">量子システム</option>
                </select>
            </div>

            <button class="btn btn-success" onclick="showApplication()">
                <i class="fas fa-eye"></i>
                <span>応用例を表示</span>
            </button>

            <div id="application-demo" class="math-card" style="display: none;">
                <h4 id="demo-title">応用例</h4>
                <div id="demo-content"></div>
            </div>

            <button class="btn btn-primary" onclick="nextSection(4)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 5: Practice Problems -->
        <div id="content-5" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-dumbbell"></i>
                    演習問題にチャレンジ
                </h3>
                <p class="section-subtitle">理解を深める実践問題</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-question-circle"></i>
                    問題 1: 基本計算
                </h4>
                <p>次の行列の固有値と固有ベクトルを求めなさい：</p>
                <div class="math-formula">
                    $$A = \begin{pmatrix} 4 & 2 \\ 1 & 3 \end{pmatrix}$$
                </div>
            </div>

            <div class="form-group">
                <label>固有値λ₁（大きい方）</label>
                <input type="number" class="form-input" id="answer1" step="0.01" placeholder="答えを入力">
            </div>

            <div class="form-group">
                <label>固有値λ₂（小さい方）</label>
                <input type="number" class="form-input" id="answer2" step="0.01" placeholder="答えを入力">
            </div>

            <button class="btn btn-success" onclick="checkAnswers()">
                <i class="fas fa-check"></i>
                <span>答えを確認</span>
            </button>

            <div id="feedback" class="status-indicator" style="display: none;"></div>

            <div class="completion-card">
                <div class="completion-header">
                    <i class="fas fa-trophy"></i>
                    <h4>コース完了！</h4>
                </div>
                <p>固有値・固有ベクトルの理解が深まりました。お疲れ様でした！</p>
                <button class="btn btn-success" onclick="window.location.href='index.html'">
                    <i class="fas fa-home"></i>
                    <span>ホームに戻る</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modern Footer for Course -->
    <footer class="course-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>学習リソース</h4>
                <ul>
                    <li><a href="#"><i class="fas fa-book"></i> 線形代数教科書</a></li>
                    <li><a href="#"><i class="fas fa-video"></i> 解説動画</a></li>
                    <li><a href="#"><i class="fas fa-calculator"></i> 計算ツール</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>関連講座</h4>
                <ul>
                    <li><a href="basis-transformation.html"><i class="fas fa-exchange-alt"></i> 基底変換</a></li>
                    <li><a href="celestial-mechanics.html"><i class="fas fa-globe"></i> 天体力学</a></li>
                    <li><a href="#"><i class="fas fa-chart-line"></i> 数値計算</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Marvelous Learning Platform - 固有値・固有ベクトルコース</p>
        </div>
    </footer>

    <!-- Modern Learning Progress Script -->
    <script>
        function updateProgress(sectionIndex) {
            const progress = ((sectionIndex + 1) / 6) * 100;
            const progressBar = document.getElementById('learning-progress');
            if (progressBar) {
                progressBar.style.width = progress + '%';
            }
        }

        function loadSectionContent(sectionIndex) {
            const controlContent = document.getElementById('control-content');
            const contentTemplate = document.getElementById(`content-${sectionIndex}`);
            
            if (contentTemplate && controlContent) {
                controlContent.innerHTML = contentTemplate.innerHTML;
                updateProgress(sectionIndex);
                
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-section="${sectionIndex}"]`).classList.add('active');
                
                if (window.MathJax) {
                    MathJax.typesetPromise([controlContent]);
                }
                
                addInputListeners();
            }
        }

        function addInputListeners() {
            const rangeInputs = document.querySelectorAll('input[type="range"]');
            rangeInputs.forEach(input => {
                const valueSpan = document.getElementById(input.id + '-value');
                
                input.addEventListener('input', function() {
                    if (valueSpan) {
                        valueSpan.textContent = parseFloat(this.value).toFixed(1);
                    }
                });
            });
        }

        function nextSection(currentSection) {
            const nextSectionIndex = currentSection + 1;
            if (nextSectionIndex < 6) {
                loadSectionContent(nextSectionIndex);
            }
        }

        // Placeholder functions for interactive features
        function setTransformation(type) {
            console.log('Setting transformation:', type);
        }

        function calculateEigenvalues() {
            const result = document.getElementById('eigenvalue-result');
            result.style.display = 'block';
            result.className = 'status-indicator independent';
            result.textContent = '固有値: λ₁ = 3, λ₂ = 1';
        }

        function animateTransformation() {
            console.log('Starting animation');
        }

        function resetVisualization() {
            console.log('Resetting visualization');
        }

        function solvePractice() {
            const solution = document.getElementById('practice-solution');
            const content = document.getElementById('solution-content');
            content.innerHTML = `
                <p><strong>固有値:</strong> λ₁ = 3, λ₂ = 2</p>
                <p><strong>固有ベクトル:</strong></p>
                <div class="math-formula">
                    $$v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad v_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$$
                </div>
            `;
            solution.style.display = 'block';
            if (window.MathJax) {
                MathJax.typesetPromise([solution]);
            }
        }

        function showApplication() {
            const demo = document.getElementById('application-demo');
            const title = document.getElementById('demo-title');
            const content = document.getElementById('demo-content');
            
            title.textContent = '振動解析の例';
            content.innerHTML = '<p>建物の固有振動数を求めることで、地震に対する共振を避ける設計が可能になります。</p>';
            demo.style.display = 'block';
        }

        function checkAnswers() {
            const answer1 = parseFloat(document.getElementById('answer1').value);
            const answer2 = parseFloat(document.getElementById('answer2').value);
            const feedback = document.getElementById('feedback');
            
            if (Math.abs(answer1 - 5) < 0.1 && Math.abs(answer2 - 2) < 0.1) {
                feedback.className = 'status-indicator independent';
                feedback.textContent = '正解です！よくできました。';
            } else {
                feedback.className = 'status-indicator dependent';
                feedback.textContent = '不正解です。もう一度計算してみてください。';
            }
            feedback.style.display = 'block';
        }

        function pauseAllAnimations() {
            console.log('Pausing animations');
        }

        // Navigation event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadSectionContent(0);
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sectionIndex = parseInt(this.dataset.section);
                    loadSectionContent(sectionIndex);
                });
            });

            if (document.referrer.includes('index.html') || document.referrer.endsWith('/')) {
                setTimeout(() => {
                    showWelcomeMessage();
                }, 1000);
            }
        });

        function showWelcomeMessage() {
            const toast = document.createElement('div');
            toast.className = 'welcome-toast';
            toast.innerHTML = `
                <div class="toast-content">
                    <i class="fas fa-graduation-cap"></i>
                    <div class="toast-text">
                        <strong>固有値・固有ベクトル講座へようこそ！</strong>
                        <p>線形変換の本質を探求しましょう</p>
                    </div>
                </div>
            `;
            
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 12px;
                padding: 1rem;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
                z-index: 1001;
                max-width: 320px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }
    </script>

    <script src="assets/eigenvalues-and-eigenvectors.js"></script>
</body>
</html>
