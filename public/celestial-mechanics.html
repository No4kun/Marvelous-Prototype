<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>天体力学の探求 - ケプラーの法則とニュートン力学</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/course-navigation.css">
    <link rel="stylesheet" href="styles/basis-transformation.css">
</head>
<body>
    <!-- Modern Header with Glassmorphism -->
    <header>
        <div class="header-nav">
            <button class="home-btn" onclick="window.location.href='index.html'" title="ホームページに戻る">
                <i class="fas fa-home"></i>
                <span>ホーム</span>
            </button>
            <div class="course-info">
                <h1>天体力学の探求</h1>
                <h2>ケプラーの法則とニュートン力学 - インタラクティブ学習</h2>
            </div>
            <button class="pause-btn" onclick="pauseAllAnimations()" title="アニメーションを一時停止">
                <i class="fas fa-pause"></i>
                <span>一時停止</span>
            </button>
        </div>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="learning-progress"></div>
            </div>
        </div>
    </header>

    <!-- Modern Learning Path Navigation -->
    <nav class="section-nav">
        <div class="container">
            <button class="nav-btn active" data-section="0">
                <i class="fas fa-rocket"></i>
                <span>導入</span>
            </button>
            <button class="nav-btn" data-section="1">
                <i class="fas fa-history"></i>
                <span>歴史</span>
            </button>
            <button class="nav-btn" data-section="2">
                <i class="fas fa-satellite"></i>
                <span>第一法則</span>
            </button>
            <button class="nav-btn" data-section="3">
                <i class="fas fa-clock"></i>
                <span>第二法則</span>
            </button>
            <button class="nav-btn" data-section="4">
                <i class="fas fa-calculator"></i>
                <span>第三法則</span>
            </button>
            <button class="nav-btn" data-section="5">
                <i class="fas fa-apple-alt"></i>
                <span>ニュートン</span>
            </button>
            <button class="nav-btn" data-section="6">
                <i class="fas fa-globe"></i>
                <span>軌道力学</span>
            </button>
            <button class="nav-btn" data-section="7">
                <i class="fas fa-dumbbell"></i>
                <span>演習</span>
            </button>
        </div>
    </nav>

    <!-- Modern Container Layout -->
    <div class="container">
        <!-- Main Canvas Container -->
        <div class="canvas-container">
            <canvas id="celestial-canvas"></canvas>
        </div>

        <!-- Modern Control Panel -->
        <div class="control-panel">
            <div class="control-header">
                <h3>
                    <i class="fas fa-space-shuttle"></i>
                    天体シミュレーション制御
                </h3>
                <p>惑星の軌道運動を体験しましょう</p>
            </div>
            <div class="control-content" id="control-content">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Hidden Content Templates -->
    <div style="display: none;">
        <!-- Section 0: Introduction Content -->
        <div id="content-0" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-rocket"></i>
                    天体力学への誘い
                </h3>
                <p class="section-subtitle">宇宙の法則を発見しよう</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-star"></i>
                    <h4>なぜ天体力学なのか？</h4>
                </div>
                <p>天体力学は、宇宙の天体がどのように運動するかを研究する学問です。この分野は：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li><strong>宇宙開発</strong>: 人工衛星や探査機の軌道設計</li>
                    <li><strong>天文学</strong>: 惑星、恒星、銀河の運動予測</li>
                    <li><strong>物理学</strong>: 重力理論の検証と応用</li>
                    <li><strong>数学</strong>: 微分方程式や力学の実例</li>
                </ul>
            </div>

            <div class="form-group">
                <label>太陽系の天体を選択</label>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="selectPlanet('mercury')">
                        <i class="fas fa-circle" style="color: #ffa500;"></i>
                        <span>水星</span>
                    </button>
                    <button class="btn btn-secondary" onclick="selectPlanet('venus')">
                        <i class="fas fa-circle" style="color: #ffc649;"></i>
                        <span>金星</span>
                    </button>
                    <button class="btn btn-secondary" onclick="selectPlanet('earth')">
                        <i class="fas fa-globe" style="color: #6b93d6;"></i>
                        <span>地球</span>
                    </button>
                    <button class="btn btn-secondary" onclick="selectPlanet('mars')">
                        <i class="fas fa-circle" style="color: #cd5c5c;"></i>
                        <span>火星</span>
                    </button>
                </div>
            </div>

            <button class="btn btn-primary" onclick="nextSection(0)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 1: Historical Context -->
        <div id="content-1" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-history"></i>
                    天体観測の歴史
                </h3>
                <p class="section-subtitle">古代から近世への発展</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-user-astronaut"></i>
                    <h4>偉大な天文学者たち</h4>
                </div>
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>プトレマイオス (2世紀)</strong>
                        <p>地球中心説（天動説）を体系化</p>
                    </div>
                    <div class="timeline-item">
                        <strong>コペルニクス (1473-1543)</strong>
                        <p>太陽中心説（地動説）を提唱</p>
                    </div>
                    <div class="timeline-item">
                        <strong>ガリレイ (1564-1642)</strong>
                        <p>望遠鏡による天体観測を開始</p>
                    </div>
                    <div class="timeline-item">
                        <strong>ケプラー (1571-1630)</strong>
                        <p>惑星運動の三法則を発見</p>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>時代を選択して天体モデルを表示</label>
                <select class="form-select" id="historical-model">
                    <option value="ptolemaic">プトレマイオス体系（天動説）</option>
                    <option value="copernican">コペルニクス体系（地動説）</option>
                    <option value="keplerian">ケプラー体系（楕円軌道）</option>
                </select>
            </div>

            <button class="btn btn-success" onclick="showHistoricalModel()">
                <i class="fas fa-eye"></i>
                <span>天体モデルを表示</span>
            </button>

            <button class="btn btn-primary" onclick="nextSection(1)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 2: First Law -->
        <div id="content-2" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-satellite"></i>
                    ケプラーの第一法則
                </h3>
                <p class="section-subtitle">楕円軌道の発見</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-formula"></i>
                    第一法則の内容
                </h4>
                <p><strong>「惑星は太陽を一つの焦点とする楕円軌道を描く」</strong></p>
                <div class="math-formula">
                    $$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$$
                </div>
                <p>ここで、a は軌道長半径、b は軌道短半径です。</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-lightbulb"></i>
                    <h4>楕円の重要なパラメータ</h4>
                </div>
                <ul style="padding-left: 1rem; line-height: 1.8;">
                    <li><strong>離心率 e</strong>: 楕円の「つぶれ具合」（0 ≤ e < 1）</li>
                    <li><strong>近日点</strong>: 太陽に最も近い点</li>
                    <li><strong>遠日点</strong>: 太陽から最も遠い点</li>
                    <li><strong>焦点</strong>: 楕円の特別な点（太陽の位置）</li>
                </ul>
            </div>

            <div class="form-group">
                <label>離心率 e</label>
                <input type="range" class="form-input" id="eccentricity" min="0" max="0.9" step="0.01" value="0.2">
                <span class="input-value" id="eccentricity-value">0.20</span>
            </div>

            <div class="form-group">
                <label>軌道長半径 a (AU)</label>
                <input type="range" class="form-input" id="semi-major" min="0.5" max="3" step="0.1" value="1">
                <span class="input-value" id="semi-major-value">1.0</span>
            </div>

            <button class="btn btn-success" onclick="updateOrbit()">
                <i class="fas fa-sync"></i>
                <span>軌道を更新</span>
            </button>

            <button class="btn btn-primary" onclick="nextSection(2)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 3: Second Law -->
        <div id="content-3" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-clock"></i>
                    ケプラーの第二法則
                </h3>
                <p class="section-subtitle">面積速度一定の法則</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-formula"></i>
                    第二法則の内容
                </h4>
                <p><strong>「惑星と太陽を結ぶ直線が等しい時間に描く面積は等しい」</strong></p>
                <div class="math-formula">
                    $$\frac{dA}{dt} = \frac{1}{2}r^2\frac{d\theta}{dt} = \text{定数}$$
                </div>
                <p>これは角運動量保存の法則の表れです。</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-info-circle"></i>
                    <h4>物理的意味</h4>
                </div>
                <p>第二法則により、惑星は：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li><strong>近日点</strong>で最も速く動く</li>
                    <li><strong>遠日点</strong>で最も遅く動く</li>
                    <li>軌道全体で<strong>角運動量が保存</strong>される</li>
                </ul>
            </div>

            <div class="form-group">
                <label>面積を測定する時間間隔（日）</label>
                <input type="range" class="form-input" id="time-interval" min="10" max="100" step="5" value="30">
                <span class="input-value" id="time-interval-value">30</span>
            </div>

            <button class="btn btn-success" onclick="demonstrateSecondLaw()">
                <i class="fas fa-play"></i>
                <span>面積変化を観察</span>
            </button>

            <div id="area-measurement" class="status-indicator" style="display: none;"></div>

            <button class="btn btn-primary" onclick="nextSection(3)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 4: Third Law -->
        <div id="content-4" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-calculator"></i>
                    ケプラーの第三法則
                </h3>
                <p class="section-subtitle">調和の法則</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-formula"></i>
                    第三法則の内容
                </h4>
                <p><strong>「惑星の公転周期の二乗は、軌道長半径の三乗に比例する」</strong></p>
                <div class="math-formula">
                    $$T^2 = \frac{4\pi^2}{GM}a^3$$
                </div>
                <p>簡単には: T² ∝ a³</p>
            </div>

            <div class="form-group">
                <label>惑星を選択して軌道データを確認</label>
                <select class="form-select" id="planet-data">
                    <option value="mercury">水星</option>
                    <option value="venus">金星</option>
                    <option value="earth">地球</option>
                    <option value="mars">火星</option>
                    <option value="jupiter">木星</option>
                    <option value="saturn">土星</option>
                </select>
            </div>

            <button class="btn btn-success" onclick="showPlanetData()">
                <i class="fas fa-chart-bar"></i>
                <span>データを表示</span>
            </button>

            <div id="planet-info" class="math-card" style="display: none;">
                <h4 id="planet-name">惑星データ</h4>
                <div id="planet-details"></div>
            </div>

            <button class="btn btn-primary" onclick="nextSection(4)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 5: Newton's Laws -->
        <div id="content-5" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-apple-alt"></i>
                    ニュートンの万有引力
                </h3>
                <p class="section-subtitle">ケプラー法則の物理的基礎</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-formula"></i>
                    万有引力の法則
                </h4>
                <div class="math-formula">
                    $$F = G\frac{m_1m_2}{r^2}$$
                </div>
                <p>この法則から、ケプラーの三法則が数学的に導出できます。</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-brain"></i>
                    <h4>ニュートンの偉大な発見</h4>
                </div>
                <p>ニュートンは、地上の物体の落下と天体の運動が同じ法則に従うことを示しました：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li>リンゴが落ちる力 = 月が地球を回る力</li>
                    <li>力の逆二乗則が楕円軌道を生む</li>
                    <li>数学（微積分）で宇宙を記述</li>
                </ul>
            </div>

            <div class="form-group">
                <label>重力の強さ（相対値）</label>
                <input type="range" class="form-input" id="gravity-strength" min="0.1" max="2" step="0.1" value="1">
                <span class="input-value" id="gravity-strength-value">1.0</span>
            </div>

            <button class="btn btn-success" onclick="simulateGravity()">
                <i class="fas fa-play"></i>
                <span>重力シミュレーション</span>
            </button>

            <button class="btn btn-primary" onclick="nextSection(5)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 6: Orbital Mechanics -->
        <div id="content-6" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-globe"></i>
                    現代の軌道力学
                </h3>
                <p class="section-subtitle">宇宙開発への応用</p>
            </div>

            <div class="insight-card">
                <div class="insight-header">
                    <i class="fas fa-satellite-dish"></i>
                    <h4>宇宙開発での応用</h4>
                </div>
                <p>ケプラーの法則は現代の宇宙技術の基礎です：</p>
                <ul style="margin-top: 1rem; padding-left: 1rem;">
                    <li><strong>人工衛星</strong>: 通信・観測・GPS衛星の軌道設計</li>
                    <li><strong>惑星探査</strong>: 火星探査機やボイジャーの軌道計算</li>
                    <li><strong>スイングバイ</strong>: 惑星の重力を利用した加速</li>
                    <li><strong>宇宙ステーション</strong>: ISS の軌道維持</li>
                </ul>
            </div>

            <div class="form-group">
                <label>軌道の種類を選択</label>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="setOrbitType('circular')">
                        <i class="fas fa-circle"></i>
                        <span>円軌道</span>
                    </button>
                    <button class="btn btn-secondary" onclick="setOrbitType('elliptical')">
                        <i class="fas fa-circle" style="transform: scaleX(0.6);"></i>
                        <span>楕円軌道</span>
                    </button>
                    <button class="btn btn-secondary" onclick="setOrbitType('transfer')">
                        <i class="fas fa-exchange-alt"></i>
                        <span>遷移軌道</span>
                    </button>
                </div>
            </div>

            <div class="form-group">
                <label>軌道高度（km）</label>
                <input type="range" class="form-input" id="orbit-altitude" min="200" max="36000" step="100" value="400">
                <span class="input-value" id="orbit-altitude-value">400</span>
            </div>

            <button class="btn btn-success" onclick="launchSatellite()">
                <i class="fas fa-rocket"></i>
                <span>衛星を軌道投入</span>
            </button>

            <button class="btn btn-primary" onclick="nextSection(6)">
                <span>次のセクションへ</span>
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>

        <!-- Section 7: Practice Problems -->
        <div id="content-7" class="section-template">
            <div class="section-header">
                <h3>
                    <i class="fas fa-dumbbell"></i>
                    演習問題にチャレンジ
                </h3>
                <p class="section-subtitle">理解度を確認しましょう</p>
            </div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-question-circle"></i>
                    問題 1: 軌道周期の計算
                </h4>
                <p>地球から 2 AU の距離にある惑星の公転周期は何年でしょうか？</p>
                <p>（ヒント: ケプラーの第三法則を使用）</p>
            </div>

            <div class="form-group">
                <label>答え（年）</label>
                <input type="number" class="form-input" id="period-answer" step="0.1" placeholder="答えを入力">
            </div>

            <button class="btn btn-success" onclick="checkPeriodAnswer()">
                <i class="fas fa-check"></i>
                <span>答えを確認</span>
            </button>

            <div id="period-feedback" class="status-indicator" style="display: none;"></div>

            <div class="math-card">
                <h4>
                    <i class="fas fa-question-circle"></i>
                    問題 2: 軌道速度
                </h4>
                <p>離心率 0.3、軌道長半径 1.5 AU の惑星の近日点での速度は、遠日点での速度の何倍でしょうか？</p>
            </div>

            <div class="form-group">
                <label>速度比</label>
                <input type="number" class="form-input" id="velocity-ratio" step="0.01" placeholder="答えを入力">
            </div>

            <button class="btn btn-success" onclick="checkVelocityAnswer()">
                <i class="fas fa-check"></i>
                <span>答えを確認</span>
            </button>

            <div id="velocity-feedback" class="status-indicator" style="display: none;"></div>

            <div class="completion-card">
                <div class="completion-header">
                    <i class="fas fa-trophy"></i>
                    <h4>天体力学コース完了！</h4>
                </div>
                <p>宇宙の法則について深い理解を得ることができました。お疲れ様でした！</p>
                <button class="btn btn-success" onclick="window.location.href='index.html'">
                    <i class="fas fa-home"></i>
                    <span>ホームに戻る</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modern Footer for Course -->
    <footer class="course-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>天文学リソース</h4>
                <ul>
                    <li><a href="#"><i class="fas fa-telescope"></i> 天体観測ガイド</a></li>
                    <li><a href="#"><i class="fas fa-calculator"></i> 軌道計算ツール</a></li>
                    <li><a href="#"><i class="fas fa-globe"></i> 惑星データベース</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>関連講座</h4>
                <ul>
                    <li><a href="basis-transformation.html"><i class="fas fa-exchange-alt"></i> 基底変換</a></li>
                    <li><a href="eigenvalues-and-eigenvectors.html"><i class="fas fa-vector-square"></i> 固有値・固有ベクトル</a></li>
                    <li><a href="#"><i class="fas fa-wave-square"></i> 物理シミュレーション</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Marvelous Learning Platform - 天体力学コース</p>
        </div>
    </footer>

    <!-- Modern Learning Progress Script -->
    <script>
        function updateProgress(sectionIndex) {
            const progress = ((sectionIndex + 1) / 8) * 100;
            const progressBar = document.getElementById('learning-progress');
            if (progressBar) {
                progressBar.style.width = progress + '%';
            }
        }

        function loadSectionContent(sectionIndex) {
            const controlContent = document.getElementById('control-content');
            const contentTemplate = document.getElementById(`content-${sectionIndex}`);
            
            if (contentTemplate && controlContent) {
                controlContent.innerHTML = contentTemplate.innerHTML;
                updateProgress(sectionIndex);
                
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-section="${sectionIndex}"]`).classList.add('active');
                
                if (window.MathJax) {
                    MathJax.typesetPromise([controlContent]);
                }
                
                addInputListeners();
            }
        }

        function addInputListeners() {
            const rangeInputs = document.querySelectorAll('input[type="range"]');
            rangeInputs.forEach(input => {
                const valueSpan = document.getElementById(input.id + '-value');
                
                input.addEventListener('input', function() {
                    if (valueSpan) {
                        valueSpan.textContent = parseFloat(this.value).toFixed(input.step == "1" ? 0 : 1);
                    }
                });
            });
        }

        function nextSection(currentSection) {
            const nextSectionIndex = currentSection + 1;
            if (nextSectionIndex < 8) {
                loadSectionContent(nextSectionIndex);
            }
        }

        // Placeholder functions for interactive features
        function selectPlanet(planet) {
            console.log('Selected planet:', planet);
        }

        function showHistoricalModel() {
            console.log('Showing historical model');
        }

        function updateOrbit() {
            console.log('Updating orbit');
        }

        function demonstrateSecondLaw() {
            const result = document.getElementById('area-measurement');
            result.style.display = 'block';
            result.className = 'status-indicator independent';
            result.textContent = '面積測定完了: 両方の領域の面積が等しいことを確認しました';
        }

        function showPlanetData() {
            const select = document.getElementById('planet-data');
            const info = document.getElementById('planet-info');
            const name = document.getElementById('planet-name');
            const details = document.getElementById('planet-details');
            
            const planetData = {
                mercury: { name: '水星', period: 0.24, distance: 0.39 },
                venus: { name: '金星', period: 0.62, distance: 0.72 },
                earth: { name: '地球', period: 1.00, distance: 1.00 },
                mars: { name: '火星', period: 1.88, distance: 1.52 },
                jupiter: { name: '木星', period: 11.86, distance: 5.20 },
                saturn: { name: '土星', period: 29.46, distance: 9.54 }
            };
            
            const planet = planetData[select.value];
            name.textContent = `${planet.name}のデータ`;
            details.innerHTML = `
                <p><strong>軌道長半径:</strong> ${planet.distance} AU</p>
                <p><strong>公転周期:</strong> ${planet.period} 年</p>
                <p><strong>T²/a³ 比:</strong> ${(planet.period ** 2 / planet.distance ** 3).toFixed(3)}</p>
            `;
            info.style.display = 'block';
        }

        function simulateGravity() {
            console.log('Simulating gravity');
        }

        function setOrbitType(type) {
            console.log('Setting orbit type:', type);
        }

        function launchSatellite() {
            console.log('Launching satellite');
        }

        function checkPeriodAnswer() {
            const answer = parseFloat(document.getElementById('period-answer').value);
            const feedback = document.getElementById('period-feedback');
            
            if (Math.abs(answer - 2.83) < 0.1) {
                feedback.className = 'status-indicator independent';
                feedback.textContent = '正解です！T² = a³ より、T = √(2³) ≈ 2.83年';
            } else {
                feedback.className = 'status-indicator dependent';
                feedback.textContent = 'もう一度計算してみてください。ヒント: T² = a³を使います';
            }
            feedback.style.display = 'block';
        }

        function checkVelocityAnswer() {
            const answer = parseFloat(document.getElementById('velocity-ratio').value);
            const feedback = document.getElementById('velocity-feedback');
            
            if (Math.abs(answer - 1.86) < 0.1) {
                feedback.className = 'status-indicator independent';
                feedback.textContent = '正解です！v₁/v₂ = (1+e)/(1-e) = 1.3/0.7 ≈ 1.86';
            } else {
                feedback.className = 'status-indicator dependent';
                feedback.textContent = 'もう一度考えてみてください。第二法則を使います';
            }
            feedback.style.display = 'block';
        }

        function pauseAllAnimations() {
            console.log('Pausing animations');
        }

        // Navigation event listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadSectionContent(0);
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const sectionIndex = parseInt(this.dataset.section);
                    loadSectionContent(sectionIndex);
                });
            });

            if (document.referrer.includes('index.html') || document.referrer.endsWith('/')) {
                setTimeout(() => {
                    showWelcomeMessage();
                }, 1000);
            }
        });

        function showWelcomeMessage() {
            const toast = document.createElement('div');
            toast.className = 'welcome-toast';
            toast.innerHTML = `
                <div class="toast-content">
                    <i class="fas fa-rocket"></i>
                    <div class="toast-text">
                        <strong>天体力学講座へようこそ！</strong>
                        <p>宇宙の法則を探求しましょう</p>
                    </div>
                </div>
            `;
            
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: white;
                border: 1px solid #e2e8f0;
                border-radius: 12px;
                padding: 1rem;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
                z-index: 1001;
                max-width: 320px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }
    </script>

    <script src="assets/celestial-mechanics.js"></script>
</body>
</html>
